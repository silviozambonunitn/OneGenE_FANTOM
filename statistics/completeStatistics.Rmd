---
title: "FANTOM OneGenE"
output: html_notebook
---
Descriptive statistics for the FANTOM OneGenE output data

Loading the matrix
```{r}
library(data.table)
matrix = fread(
  file = "/storage/shared/fantom/FANTOM_unified.csv",
  sep = ';',
  header = T,
  verbose = F
)
```

Correlation distribution
```{r}
library(ggplot2)
plot = ggplot() +
  theme_bw() +
  geom_density(aes(matrix$PearsonCorrelation)) +
  geom_vline(aes(xintercept = mean(matrix$PearsonCorrelation)),
             color = "blue")
plot = plot + labs(
  x = "Pearson correlation coefficient",
  y = "Density",
  title = "Transcripts with relative frequency > 0",
  caption = "Blue line = mean"
) +
  scale_x_continuous(breaks = seq(-0.75, 1, 0.1))
plot
```

Scatterplot of relative freq and correlation
```{r}
library(scattermore)
scattermoreplot(
  matrix$RelativeFrequency,
  matrix$PearsonCorrelation
)
# ggsave(
#   path = "/storage/shared/fantom/",
#   filename = "scatter_no_abs.png",
#   width = 7,
#   height = 5,
#   units = "in",
#   dpi = 300,
#   device = "png"
# )
```
Scatterplot of relative freq and absolute value of correlation
```{r}
library(scattermore)
scattermoreplot(
  matrix$RelativeFrequency,
  abs(matrix$PearsonCorrelation)
)
# ggsave(
#   path = "/storage/shared/fantom/",
#   filename = "scatter_no_abs.png",
#   width = 7,
#   height = 5,
#   units = "in",
#   dpi = 300,
#   device = "png"
# )
```


